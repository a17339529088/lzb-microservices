# Nacos配置中心配置说明
# 本文件定义了需要在Nacos配置中心创建的配置项

# ============================================
# 1. 公共配置 (common-config.yml)
# Data ID: common-config.yml
# Group: DEFAULT_GROUP
# 配置格式: YAML
# ============================================
common-config:
  description: "所有微服务共享的公共配置"
  content: |
    # JWT配置
    jwt:
      secret: lzb-jwt-secret-key-2024
      expiration: 86400000  # 24小时
    
    # 日志配置
    logging:
      level:
        com.lzb: INFO
        org.springframework: INFO
    
    # Actuator配置
    management:
      endpoints:
        web:
          exposure:
            include: health,info

# ============================================
# 2. UAA服务配置 (lzb-uaa-docker.yml)
# Data ID: lzb-uaa-docker.yml
# Group: DEFAULT_GROUP
# 配置格式: YAML
# ============================================
lzb-uaa-docker:
  description: "UAA认证服务的Docker环境配置"
  content: |
    spring:
      datasource:
        url: jdbc:mysql://mysql:3306/lzb_microservices?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
        username: root
        password: root123
        driver-class-name: com.mysql.cj.jdbc.Driver
      data:
        redis:
          host: redis
          port: 6379
          database: 0
      # GitHub OAuth2 配置
      # 申请地址: https://github.com/settings/developers
      # 回调URL: http://your-domain:7573/login/oauth2/code/github
      # 注意：请将下面的 client-id 和 client-secret 替换为你自己的值
      security:
        oauth2:
          client:
            registration:
              github:
                client-id: your-github-client-id        # 替换为你的 GitHub Client ID
                client-secret: your-github-client-secret # 替换为你的 GitHub Client Secret
                scope: read:user,user:email
            provider:
              github:
                authorization-uri: https://github.com/login/oauth/authorize
                token-uri: https://github.com/login/oauth/access_token
                user-info-uri: https://api.github.com/user
                user-name-attribute: login
    
    # LDAP 配置
    ldap:
      url: ldap://openldap:389
      base: dc=example,dc=org
      userDn: cn=admin,dc=example,dc=org
      password: admin
    
    # JWT 配置
    jwt:
      secret: lzb-microservices-jwt-secret-key-2024-very-long-and-secure
      expiration: 10800  # 3小时（单位：秒）
    
    server:
      port: 9999
    
    mybatis-flex:
      configuration:
        map-underscore-to-camel-case: true
        log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
      global-config:
        logic-delete-column: deleted
        logic-delete-value: 1
        logic-normal-value: 0
    
    # 日志配置
    logging:
      level:
        com.lzb.uaa: DEBUG
        org.springframework.security: DEBUG

# ============================================
# 3. Product服务配置 (lzb-product-docker.yml)
# Data ID: lzb-product-docker.yml
# Group: DEFAULT_GROUP
# 配置格式: YAML
# ============================================
lzb-product-docker:
  description: "Product产品服务的Docker环境配置"
  content: |
    spring:
      datasource:
        url: jdbc:mysql://mysql:3306/lzb_microservices?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
        username: root
        password: root123
        driver-class-name: com.mysql.cj.jdbc.Driver
    
    server:
      port: 8081
    
    mybatis-flex:
      configuration:
        map-underscore-to-camel-case: true
        log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
      global-config:
        logic-delete-column: deleted
        logic-delete-value: 1
        logic-normal-value: 0

# ============================================
# 4. Gateway服务配置 (lzb-gateway-docker.yml)
# Data ID: lzb-gateway-docker.yml
# Group: DEFAULT_GROUP
# 配置格式: YAML
# ============================================
lzb-gateway-docker:
  description: "Gateway网关服务的Docker环境配置"
  content: |
    spring:
      cloud:
        gateway:
          routes:
            - id: uaa-service
              uri: lb://lzb-uaa
              predicates:
                - Path=/uaa/**
            - id: product-service
              uri: lb://lzb-product
              predicates:
                - Path=/api/products/**
      data:
        redis:
          host: redis
          port: 6379
          database: 0
    
    server:
      port: 7573
    
    jwt:
      secret: lzb-jwt-secret-key-2024

# ============================================
# 配置导入说明
# ============================================
# 
# 方式1: 通过Nacos控制台手动导入
# 1. 访问 http://localhost:8848/nacos (用户名/密码: nacos/nacos)
# 2. 进入"配置管理" -> "配置列表"
# 3. 点击"+"创建配置
# 4. 填写Data ID、Group、配置格式，粘贴上述content内容
# 5. 点击"发布"
#
# 方式2: 通过Nacos Open API导入
# curl -X POST 'http://localhost:8848/nacos/v1/cs/configs' \
#   -d 'dataId=common-config.yml' \
#   -d 'group=DEFAULT_GROUP' \
#   -d 'content=<配置内容>' \
#   -d 'type=yaml'
#
# 方式3: 使用本项目提供的导入脚本
# bash scripts/import-nacos-config.sh
#
# ============================================
# 环境变量说明
# ============================================
# 
# GITHUB_CLIENT_ID: GitHub OAuth应用的Client ID
# GITHUB_CLIENT_SECRET: GitHub OAuth应用的Client Secret
# 
# 这些环境变量需要在Nacos配置中心或docker-compose.yml中设置
